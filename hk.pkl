amends "package://github.com/jdx/hk/releases/download/v1.28.0/hk@1.28.0#/Config.pkl"

local cargo_fmt = new Step {
    glob = List("*.rs")
    check = "cargo fmt --all -- --check"
    fix = "cargo fmt --all"
    stage = List("*.rs")
}

local cargo_clippy = new Step {
    glob = List("*.rs")
    check = "cargo clippy --all-targets --all-features -- -D warnings"
}

hooks {
    ["pre-push"] {
        steps {
            ["cargo-fmt"] = cargo_fmt
            ["cargo-clippy"] = cargo_clippy
        }
    }
    ["fix"] {
        fix = true
        steps {
            ["cargo-fmt"] = cargo_fmt
            ["cargo-clippy"] = cargo_clippy
        }
    }
    ["check"] {
        fix = false
        steps {
            ["cargo-fmt"] = cargo_fmt
            ["cargo-clippy"] = cargo_clippy
        }
    }
}
